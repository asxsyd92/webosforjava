layui.config({
    base: 'Common/layim/layui_exts/' //指定 winui 路径 //假设这是cookie.js所在的目录（本页面的相对路径）
}).extend({ //设定模块别名
    Vue: 'Vue'
//  如果js是在根目录，也可以不用设定别名,因为我js的是在根目录，所以这句话其实也不用写也行。
        , VueRouter: 'VueRouter', httpVueLoader: 'httpVueLoader', common: 'common'
    }); var $ = null;
layui.use(["element", "layer", "form", "util", "flow", "layedit", 'Vue', 'VueRouter', 'httpVueLoader', 'common' , 'ClipboardJS'],
    function () {
        $ = layui.jquery, element = layui.element; var Vue = layui.Vue, VueRouter = layui.VueRouter, httpVueLoader = layui.httpVueLoader, common = layui.common, ClipboardJS = layui.ClipboardJS;


        if (!!window.ActiveXObject || "ActiveXObject" in window) {
            //询问框
            layer.confirm('你的浏览器不支持，请使用其他浏览器如：306浏览器、谷歌浏览器、uc浏览器等？', {
                btn: ['下载谷歌浏览器', '不用了'] //按钮
            }, function () {
                layer.open({
                    type: 2, maxmin: true, //开启最大化最小化按钮
                    title: "下载谷歌浏览器" ,
                    shade: 0.8,
                    area: ['80%', '80%'],
                    shadeClose: true,
                    content: "https://asxsdyd92.pipipan.com/fs/1221088-388271680",
                    skin: 'layui-layer-lan'
                    , closeBtn: 1
                    , anim: 4 //动画类型
                });
                }, function () {
                    layer.close();
            });
        }
       
 
            Vue.config.devtools.debug = true;
            const menus = [
             
                {
                    show:true,
                    ioc: "fa fa-book fa-spin",
                    name: "我的作品",
                    path: "/product",
                    component: "/PortalSite/product.html"
                },
                {
                    show: true,
                    ioc: "fa fa-download fa-spin",
                    name: "分享下载",
                    path: "/soso",
                    component: "/PortalSite/soso.html"
                }, 
                {
                    show: true,
                    ioc: "fa fa-shopping-cart fa-spin",
                    name: "淘券券",
                    path: "/taobao",
                    component: "/PortalSite/taobao.html"
                }, 
                {
                    show: true,
                    ioc: "fa fa-grav fa-open",
                    name: "开发者",
                    path: "/open/:type",
                    component: "/PortalSite/open.html"
                }, {
                    show: true,
                    ioc: "fa fa-free-code-camp fa-spin",
                    name: "磁力链接",
                    path: "/bt",
                    component: "/PortalSite/bt.html"
                }, {
                    show: false ,
                    ioc: "",
                    name: "详情",
                    path: "/newsDetail/:key",
                    component: "/PortalSite/newsDetail.html"
                },  
                // 重定向
                {
                    show: false,
                    path: '*',
                    redirect: '/mian',
                   component: "/PortalSite/mian.html"
                }
            ];
            let routes = []; let _muen = [];
            $(menus).each(function (index, menu) {

                //  for (let menu of menus) {
                if (menu.show) {
                    _muen.push(menu);
                }
                routes.push({
                    path: menu.path,
                    component: httpVueLoader(menu.component)
                });
            });

            const router = new VueRouter({
                routes: routes
            });
        var us = new Array();
        us.id = window.localStorage["userid"];
        us.name = window.localStorage["user"];
        us.orid = window.localStorage["orid"];
        us.orname = window.localStorage["orname"];
        us.picture = window.localStorage["picture"];
      
          _vue=  Vue.use(httpVueLoader);
        new Vue({
           
                router: router,
                el: '#app',
            data: {
                users: us,
                    menus: _muen
            }
             
            });
        $(".blog-navicon").click(function () {
            var t = new RegExp("layui-hide");
            t.test($(".blog-nav-left").attr("class")) ? openmuen() : closemuen();
        });
        if (window.localStorage["userid"] === null || window.localStorage["userid"] === undefined) {
      
            $("#login").show();
            $("#outlogin").hide();

        } else {
            $("#qqtouxiang")[0].src = window.localStorage["picture"];
            $("#qqname").html( window.localStorage["user"]);
            $("#login").hide();
            $("#outlogin").show();
            element.on('nav(nvdfilter)', function (data) {
                if (data.parent()[0].className === "layui-nav-item") {
                    data.parent()[0].className = "layui-nav-item  layui-nav-itemed";
                } else {
                    data.parent()[0].className = "layui-nav-item";
                }
            });
            element.render();
        }
    
    });
Date.prototype.Format = function (n) {
    var t = n;
    return t = t.replace(/yyyy|YYYY/, this.getFullYear()),
        t = t.replace(/yy|YY/, this.getYear() % 100 > 9 ? (this.getYear() % 100).toString() : "0" + this.getYear() % 100),
        t = t.replace(/MM/, this.getMonth() + 1 > 9 ? (this.getMonth() + 1).toString() : "0" + (this.getMonth() + 1)),
        t = t.replace(/M/g, this.getMonth() + 1),
        t = t.replace(/w|W/g, ["日", "一", "二", "三", "四", "五", "六"][this.getDay()]),
        t = t.replace(/dd|DD/, this.getDate() > 9 ? this.getDate().toString() : "0" + this.getDate()),
        t = t.replace(/d|D/g, this.getDate()),
        t = t.replace(/hh|HH/, this.getHours() > 9 ? this.getHours().toString() : "0" + this.getHours()),
        t = t.replace(/h|H/g, this.getHours()),
        t = t.replace(/mm/, this.getMinutes() > 9 ? this.getMinutes().toString() : "0" + this.getMinutes()),
        t = t.replace(/m/g, this.getMinutes()),
        t = t.replace(/ss|SS/, this.getSeconds() > 9 ? this.getSeconds().toString() : "0" + this.getSeconds()),
        t.replace(/s|S/g, this.getSeconds())
};

$(".blog-navicon").click(function () {
    var t = new RegExp("layui-hide");
    t.test($(".blog-nav-left").attr("class")) ? openmuen() : closemuen();
});
function showTime() {
    try {
        var time = document.getElementById("datatime");
        var show_time = document.getElementById("show_time");

        var da = new Date();
        time.innerHTML = da.getFullYear() + "-" + (da.getMonth() + 1) + "-" + da.getDate();
        show_time.innerHTML = da.getHours() + ":" + da.getMinutes() + ":" + da.getSeconds() + ' 星期' + '日一二三四五六'.charAt(da.getDay());
    } catch (e) { console.log(e); }

}
function openmuen() {

    //$("#_on_off")[0].removeclass("fa-navicon");
    //$("#_on_off")[0].addclass("fa-times");
    $(".blog-mask").unbind("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend");
    $(".blog-nav-left").unbind("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend");
    $(".blog-mask").removeClass("maskOut");
    $(".blog-mask").addClass("maskIn");
    $(".blog-mask").removeClass("layui-hide");
    $(".blog-mask").addClass("layui-show");
    $(".blog-nav-left").removeClass("leftOut");
    $(".blog-nav-left").addClass("leftIn");
    $(".blog-nav-left").removeClass("layui-hide");
    $(".blog-nav-left").addClass("layui-show");

}

function closemuen() {

    //$("#_on_off")[0].removeClass("fa-times");
    //$("#_on_off")[0].addClass("fa-navicon");
    $(".blog-mask").on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",
        function () {

            $(".blog-mask").addClass("layui-hide")
        });
    $(".blog-nav-left").on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",
        function () {

            $(".blog-nav-left").addClass("layui-hide")
        });
    $(".blog-mask").removeClass("maskIn");
    $(".blog-mask").addClass("maskOut");
    $(".blog-mask").removeClass("layui-show");
    $(".blog-nav-left").removeClass("leftIn");
    $(".blog-nav-left").addClass("leftOut");
    $(".blog-nav-left").removeClass("layui-show")
}